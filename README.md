# Веб-сервис "Archive Vision"

Данный репозиторий содержит веб-сервис, который позволит архивам Москвы в автоматизированном режиме извлекать из данные из образов архивных документов и наполнять ими базу данных.

<div align="center">
<img src="https://github.com/user-attachments/assets/010d2199-5c2c-4428-a2f0-76f637ad35e1" width="600"><br>



<em>Пример расшифровки документа</em>
</div>

---

### Почему мы делали этот проект?

Нам было интересно поработать с современными моделями OCR, в частности **TrOCR**, произвести разметку датасета с архивными изображениями, а также получить опыт создания полноценного веб-сервиса с применением моделей ИИ.

---

### Используемые технологии:

Backend & API
* Python
* FastAPI
* Uvicorn
* Pydantic

Machine Learning & Data Science
* PyTorch
* Hugging Face Transformers
* NumPy & SciPy
* OpenCV & Pillow
* pdf2image

Frontend & Визуализация
* Streamlit

База Данных
* PostgreSQL


---

### Структура проекта

```
ARCHIVE_VISION/
│
├── backend/
│   ├── database.py       # Управляет подключением к базе данных, моделями и логикой ORM
│   ├── main.py           # Основная точка входа в бэкэнд-приложение
│   ├── ocr.py            # Обрабатывает OCR и вывод модели
│   └── utils.py          # Утилитарные функции для бэкэнда
│
├── front/
│   ├── temp_uploads/     # Временное хранилище для файлов, загруженных пользователями
│   ├── app.py            # Логика фронтенд-приложения
│   └── corrections.json  # Конфигурация для исправления результатов OCR
│
├── presentation/
│   └── bestbmstu.pptx    # Слайды презентации проекта
│
├── .gitignore
├── generate_db.sql       # SQL-скрипт для инициализации схемы БД
├── LICENSE
├── README.md
└── requirements.txt

```


---

### Установка

Для настройки среды проекта выполните следующее:

1. **Клонируйте репозиторий:**

   ```bash
   git clone https://github.com/mikhailvokhrameev/archive_vision.git
   cd archive_vision
   ```
2. **Создайте и активируйте виртуальное окружение (рекомендуется):**

   ```bash
   # Создание окружения
   python3 -m venv venv

   # Активация на macOS/Linux:
   source venv/bin/activate

   # Активация на Windows:
   # venv\Scripts\activate
   ```
3. **Установите:**

   ```bash
   pip install -r requirements.txt
   ```

---

### Использование

**Важно:** Все команды должны запускаться из корневой папки проекта.

#### Шаг 1: Запуск бекенда

Этот скрипт запускает бекэнд на http://0.0.0.0:8000. Для изменения порта или IP требуется в файле main.py изменить соответственные аргументы в `uvicorn.run("main:app", host="0.0.0.0", port=8000, reload=True)`

```bash
python ./backend/main.py
```

#### Шаг 2: Запуск фронтенда

Этот скрипт запускает фронтенд приложения на http://127.0.0.1:8000. Для изменения порта или IP требуется добавить в переменные окружения в docker файле API_BASE_URL ссылку на сервер.

```bash
streamlit run ./front/app.py
```

#### Шаг 3: Настройка БД

В качестве базы данных используется PostgreSQL. Скрипт для создания таблиц в базеданных представлен в файле generate_db.sql. Для связи бекенда с БД требуется в файле backend\database.py изменить:

* DB_USER - имя администратора БД;
* DB_PASS - пароль администратора;
* DB_HOST - IP адрес БД;
* DB_PORT - порт для подключения к БД;
* DB_NAME - название базы данных.


#### Шаг 4: Работа с сервисом

Вся работа с сервисом происходит через фронтенд (по умолчанию http://127.0.0.1:8000). Для загрузки и обработки документа требуется загрузить файл изображения документа через интерфейс.
